/**
 * Created by kenji-special on 10/19/14.
 */
define([
    "backbone",

    'models/window-model'
], function (Backbone, windowModel) {
    // 文字の情報
    // height / width
    var rate = 1/5;
    var size = 200 * windowModel.scaleFactor;
    var heightSize = size * rate;

    var l0=[ [0.016, 0.9025000000000001], [0.016, 0.15], [0.0565, 0.15], [0.0565, 0.7375], [0.11449999999999999, 0.7375], [0.11449999999999999, 0.9025000000000001], [0.016, 0.9025000000000001] ];
    var l1=[ [0.27949999999999997, 0.525], [0.27949999999999997, 0.6525000000000001, 0.27349999999999997, 0.7474999999999999,0.26099999999999995, 0.8125], [0.24849999999999997, 0.8775000000000001, 0.23049999999999998, 0.9099999999999999,0.2065, 0.9099999999999999], [0.18299999999999997, 0.9099999999999999, 0.165, 0.8775000000000001,0.15249999999999997, 0.8099999999999999], [0.13999999999999999, 0.7449999999999999, 0.13349999999999998, 0.6475,0.13349999999999998, 0.5199999999999999], [0.13349999999999998, 0.3949999999999999, 0.13999999999999999, 0.29999999999999993,0.15249999999999997, 0.23249999999999993], [0.18299999999999997, 0.13249999999999992,0.207, 0.13249999999999992], [0.23099999999999998, 0.13249999999999992, 0.249, 0.16499999999999992,0.2615, 0.22999999999999993], [0.273, 0.3025, 0.27949999999999997, 0.3975,0.27949999999999997, 0.525] ];
    var l2=[ [0.17600000000000002, 0.525], [0.17600000000000002, 0.67, 0.18600000000000003, 0.7424999999999999,0.20650000000000002, 0.7424999999999999], [0.21700000000000003, 0.7424999999999999, 0.22450000000000003, 0.725,0.22950000000000004, 0.69], [0.23450000000000004, 0.655, 0.23700000000000002, 0.5999999999999999,0.23700000000000002, 0.525], [0.23700000000000002, 0.45, 0.23450000000000004, 0.395,0.22950000000000004, 0.36], [0.22450000000000003, 0.325, 0.21700000000000003, 0.3075,0.20700000000000002, 0.3075], [0.18600000000000003, 0.305, 0.17600000000000002, 0.3775,0.17600000000000002, 0.525] ];
    var l3=[ [0.3985, 0.9025000000000001], [0.391, 0.7625], [0.342, 0.7625], [0.335, 0.9025000000000001], [0.29, 0.9025000000000001], [0.33899999999999997, 0.14750000000000005], [0.39299999999999996, 0.14750000000000005], [0.4425, 0.9025000000000001], [0.3985, 0.9025000000000001] ];
    var l4=[ [0.38299999999999995, 0.595], [0.3765, 0.4725], [0.375, 0.44499999999999995, 0.373, 0.41,0.371, 0.36499999999999994], [0.369, 0.32249999999999995, 0.3675, 0.2899999999999999,0.3665, 0.27249999999999996], [0.366, 0.2899999999999999, 0.36449999999999994, 0.31999999999999995,0.363, 0.36], [0.36099999999999993, 0.39999999999999997, 0.357, 0.48,0.3509999999999999, 0.5974999999999999], [0.38299999999999995, 0.5974999999999999] ];
    var l5=[ [0.5870000000000001, 0.51], [0.5870000000000001, 0.635, 0.58, 0.7324999999999999,0.5665, 0.8], [0.5525000000000001, 0.8675, 0.5335000000000001, 0.9025000000000001,0.5085000000000001, 0.9025000000000001], [0.4600000000000001, 0.9025000000000001], [0.4600000000000001, 0.15], [0.5120000000000001, 0.15], [0.536, 0.15, 0.5545000000000001, 0.18,0.5680000000000001, 0.2425], [0.58, 0.305, 0.5870000000000001, 0.395,0.5870000000000001, 0.51] ];
    var l6=[ [0.5445, 0.5175], [0.5445, 0.44749999999999995, 0.542, 0.39749999999999996,0.5365000000000001, 0.365], [0.5310000000000001, 0.33249999999999996, 0.523, 0.315,0.5115000000000001, 0.315], [0.5, 0.315], [0.5, 0.735], [0.509, 0.735], [0.5215, 0.735, 0.5305, 0.7175,0.536, 0.6824999999999999], [0.542, 0.645, 0.5445, 0.5900000000000001,0.5445, 0.5175] ];
    var l7=[ [0.6135, 0.9025000000000001], [0.6135, 0.15], [0.6545000000000001, 0.15], [0.6545000000000001, 0.9], [0.6135, 0.9] ];
    var l8=[ [0.83, 0.9025000000000001], [0.777, 0.9025000000000001], [0.722, 0.37250000000000005], [0.7210000000000001, 0.37250000000000005], [0.7225000000000001, 0.45500000000000007, 0.7230000000000001, 0.5200000000000001,0.7230000000000001, 0.5625], [0.7230000000000001, 0.9], [0.6870000000000002, 0.9], [0.6870000000000002, 0.15], [0.74, 0.15], [0.7945, 0.6725], [0.795, 0.6725], [0.794, 0.5974999999999999, 0.7935, 0.5349999999999999,0.7935, 0.48999999999999994], [0.7935, 0.15], [0.8294999999999999, 0.15], [0.8294999999999999, 0.9025000000000001] ];
    var l9=[ [0.9229999999999999, 0.4625], [0.988, 0.4625], [0.988, 0.8675], [0.9704999999999999, 0.8975000000000002, 0.951, 0.9125,0.93, 0.9125], [0.907, 0.9125, 0.889, 0.8800000000000001,0.8765000000000001, 0.8125], [0.8640000000000001, 0.745, 0.8575, 0.65,0.8575, 0.525], [0.8575, 0.4025, 0.8645, 0.31,0.8785, 0.2425], [0.8925, 0.175, 0.9114999999999999, 0.1425,0.9364999999999999, 0.1425], [0.946, 0.1425, 0.9549999999999998, 0.1475,0.9634999999999999, 0.15499999999999997], [0.9719999999999999, 0.16499999999999998, 0.9789999999999999, 0.175,0.9854999999999999, 0.19], [0.9725, 0.35], [0.9615, 0.3225, 0.95, 0.31,0.937, 0.31], [0.925, 0.31, 0.916, 0.33,0.9095, 0.3675], [0.9, 0.45999999999999996,0.9, 0.5325], [0.9, 0.6024999999999999, 0.903, 0.6549999999999999,0.909, 0.6924999999999999], [0.915, 0.7299999999999999, 0.9235000000000001, 0.7474999999999998,0.9345, 0.7474999999999998], [0.9405, 0.7474999999999998, 0.9460000000000001, 0.7449999999999999,0.9510000000000001, 0.7399999999999999], [0.9510000000000001, 0.6224999999999998], [0.924, 0.6224999999999998], [0.924, 0.4625] ];

    var letterArr = [l0, l1, l2, l3, l4, l5, l6, l7, l8, l9];
    var letterCount = [40, 40, 30, 40, 20, 40, 20, 40, 60, 60];

    var LoaderLetter = function () {
        this.widthSize = size;
        this.heightSize = heightSize;

        this.letterPtArr   = [];
        this.letterCompleteBoolArr = [];

        for (var ii = 0; ii < letterArr.length; ii++) {
            this.letterPtArr[ii] = [];
            this.letterCompleteBoolArr[ii] = false;

            this.textNumber = letterCount[ii];
            var kankakuDuration = parseInt(this.textNumber / letterArr[ii].length);
            var curNumber = this.textNumber;

            for (var jj = 0; jj < letterArr[ii].length; jj++) {
                for (var kk = 0; kk < kankakuDuration; kk++) {
                    var ptX, ptY;

                    var rate = kk / kankakuDuration;
                    var curNum = jj;
                    var nextNum = (jj + 1) % letterArr[ii].length;

                    if (letterArr[ii][nextNum].length == 6) {
                        //ptX = kenjiArr[ii][curNum][0] * size * (1 - rate) +  kenjiArr[ii][nextNum][0] * size * rate;
                        //ptY = kenjiArr[ii][curNum][1] * size * (1 - rate) +  kenjiArr[ii][nextNum][1] * size * rate;
                        var x1, y1, x2, y2, x3, y3, x4, y4;
                        if (letterArr[ii][curNum].length == 2) {
                            x1 = letterArr[ii][curNum][0] * size;
                            y1 = letterArr[ii][curNum][1] * heightSize;
                        } else if(letterArr[ii][curNum].length == 4) {
                            x1 = letterArr[ii][curNum][2] * size;
                            y1 = letterArr[ii][curNum][3] * heightSize;
                        } else if (letterArr[ii][curNum].length == 6) {
                            x1 = letterArr[ii][curNum][4] * size;
                            y1 = letterArr[ii][curNum][5] * heightSize;
                        }

                        x2 = letterArr[ii][nextNum][0] * size;
                        y2 = letterArr[ii][nextNum][1] * heightSize;
                        x3 = letterArr[ii][nextNum][2] * size;
                        y3 = letterArr[ii][nextNum][3] * heightSize;
                        x4 = letterArr[ii][nextNum][4] * size;
                        y4 = letterArr[ii][nextNum][5] * heightSize;


                        ptX = x1 * (1 - rate) * (1 - rate) * (1 - rate) + x2 * 3 * (1 - rate) * (1 - rate) * rate + x3 * 3 * (1 - rate) * rate * rate + rate * rate * rate * x4;
                        ptY = y1 * (1 - rate) * (1 - rate) * (1 - rate) + y2 * 3 * (1 - rate) * (1 - rate) * rate + y3 * 3 * (1 - rate) * rate * rate + rate * rate * rate * y4;

                    } else if(letterArr[ii][nextNum].length == 4){
                        var x1, y1, x2, y2, x3, y3;
                        if (letterArr[ii][curNum].length == 2) {
                            x1 = letterArr[ii][curNum][0] * size;
                            y1 = letterArr[ii][curNum][1] * heightSize;
                        } else if(letterArr[ii][curNum].length == 4) {
                            x1 = letterArr[ii][curNum][2] * size;
                            y1 = letterArr[ii][curNum][3] * heightSize;
                        } else if (letterArr[ii][curNum].length == 6) {
                            x1 = letterArr[ii][curNum][4] * size;
                            y1 = letterArr[ii][curNum][5] * heightSize;
                        }

                        x2 = letterArr[ii][nextNum][0] * size;
                        y2 = letterArr[ii][nextNum][1] * heightSize;
                        x3 = letterArr[ii][nextNum][2] * size;
                        y3 = letterArr[ii][nextNum][3] * heightSize;

                        ptX = x1 * (1-rate)*(1-rate) + x2 * 2 *(1-rate)*rate + x3 * rate * rate;
                        ptY = y1 * (1-rate)*(1-rate) + y2 * 2 *(1-rate)*rate + y3 * rate * rate;

                    }else{
                        if (letterArr[ii][curNum].length == 2) {
                            ptX = letterArr[ii][curNum][0] * size * (1 - rate) + letterArr[ii][nextNum][0] * size * rate;
                            ptY = letterArr[ii][curNum][1] * heightSize * (1 - rate) + letterArr[ii][nextNum][1] * heightSize * rate;
                        } else if (letterArr[ii][curNum].length == 4) {
                            ptX = letterArr[ii][curNum][2] * size * (1 - rate) + letterArr[ii][nextNum][0] * size * rate;
                            ptY = letterArr[ii][curNum][3] * heightSize * (1 - rate) + letterArr[ii][nextNum][1] * heightSize * rate;
                        }else if (letterArr[ii][curNum].length == 6) {
                            ptX = letterArr[ii][curNum][4] * size * (1 - rate) + letterArr[ii][nextNum][0] * size * rate;
                            ptY = letterArr[ii][curNum][5] * heightSize * (1 - rate) + letterArr[ii][nextNum][1] * heightSize * rate;
                        }
                    }

                    var pos = {x: ptX - size / 2, y: ptY - heightSize / 2};
                    this.letterPtArr[ii].push(pos);
                }
                curNumber -= kankakuDuration;
                if (kankakuDuration > curNumber) kankakuDuration = curNumber;
            }
        }

    };

    LoaderLetter.prototype = {
        textNumber : 60
    };

    var loaderLetter = new LoaderLetter();

    return loaderLetter;
});
